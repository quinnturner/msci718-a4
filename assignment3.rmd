---
title: "Assignment3"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(pastecs)

#set up datasets
redWineData <- read.csv("winequality-red.csv", header=T, sep = ";")
redWineData$color <- 1
redWineData$pHTransformed <- 10^redWineData$pH
redWineData$pH <- NULL
whiteWineData <- read.csv("winequality-white.csv", header=T, sep = ";")
whiteWineData$color <- 0
whiteWineData$pHTransformed <- 10^whiteWineData$pH
whiteWineData$pH <- NULL


head(whiteWineData)
head(redWineData)

wineData <- rbind(whiteWineData, redWineData)

str(wineData)
```

##Exploratory Data Analysis
```{r}
# Per-variable histogram

ggplot(wineData, aes(fixed.acidity)) + geom_histogram(aes(y=..density..), binwidth = .1, color="darkblue", fill="lightblue") + labs(title = 'Histogram of fixed acidity', x = 'Fixed acidity') + geom_vline(aes(xintercept=mean(fixed.acidity)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(volatile.acidity)) + geom_histogram(aes(y=..density..), binwidth = .1, color="darkblue", fill="lightblue") + labs(title = 'Histogram of volatile acidity', x = 'Volatile acidity') + geom_vline(aes(xintercept=mean(volatile.acidity)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(citric.acid)) + geom_histogram(aes(y=..density..), binwidth = .1, color="darkblue", fill="lightblue") + labs(title = 'Histogram of citric acid', x = 'Citric acid') + geom_vline(aes(xintercept=mean(citric.acid)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(residual.sugar)) + geom_histogram(aes(y=..density..), binwidth = 1, color="darkblue", fill="lightblue") + labs(title = 'Histogram of residual sugar', x = 'Residual sugar') + geom_vline(aes(xintercept=mean(residual.sugar)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(chlorides)) + geom_histogram(aes(y=..density..), binwidth = .01, color="darkblue", fill="lightblue") + labs(title = 'Histogram of chlorides', x = 'Chlorides') + geom_vline(aes(xintercept=mean(chlorides)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(free.sulfur.dioxide)) + geom_histogram(aes(y=..density..), binwidth = 5, color="darkblue", fill="lightblue") + labs(title = 'Histogram of free sulfur dioxide', x = 'Free sulfur dioxide') + geom_vline(aes(xintercept=mean(free.sulfur.dioxide)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(total.sulfur.dioxide)) + geom_histogram(aes(y=..density..), binwidth = 5, color="darkblue", fill="lightblue") + labs(title = 'Histogram of total sulfur dioxide', x = 'Total sulfur dioxide') + geom_vline(aes(xintercept=mean(total.sulfur.dioxide)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(density)) + geom_histogram(aes(y=..density..), binwidth = .001, color="darkblue", fill="lightblue") + labs(title = 'Histogram of density', x = 'Density') + geom_vline(aes(xintercept=mean(density)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(sulphates)) + geom_histogram(aes(y=..density..), binwidth = .1, color="darkblue", fill="lightblue") + labs(title = 'Histogram of sulphates', x = 'Sulphates') + geom_vline(aes(xintercept=mean(sulphates)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(alcohol)) + geom_histogram(aes(y=..density..), binwidth = .5, color="darkblue", fill="lightblue") + labs(title = 'Histogram of alcohol', x = 'Alcohol') + geom_vline(aes(xintercept=mean(alcohol)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")

ggplot(wineData, aes(quality)) + geom_histogram(aes(y=..density..), binwidth = 1, color="darkblue", fill="lightblue") + labs(title = 'Histogram of quality', x = 'Quality') + geom_vline(aes(xintercept=mean(quality)), color="red", linetype="dashed", size=1)

ggplot(wineData, aes(color)) + geom_histogram(binwidth = 1, color="darkblue", fill="lightblue") + labs(title = 'Histogram of color', x = 'Color') + geom_vline(aes(xintercept=mean(color)), color="red", linetype="dashed", size=1)

ggplot(wineData, aes(pHTransformed)) + geom_histogram(aes(y=..density..), binwidth = 100, color="darkblue", fill="lightblue") + labs(title = 'Histogram of pH transformed', x = 'pH transformed') + geom_vline(aes(xintercept=mean(pHTransformed)), color="red", linetype="dashed", size=1) + geom_density(alpha=.2, fill="#FF6666")
```

```{r}
ggplot(wineData, aes(y=quality, x=density)) + geom_point() + geom_jitter(width=0.25)
ggplot(wineData, aes(y=quality, x=color)) + geom_point() + geom_jitter(width=0.25)

# Check variable dependence

ggplot(wineData, aes(fixed.acidity)) + geom_histogram()
qqplot.fixed.acidity <- ggplot(wineData, aes(sample=fixed.acidity)) + stat_qq() + geom_qq_line()
qqplot.fixed.acidity
stat.desc(redWineData$fixed.acidity, basic=F, norm=T) #red 
shapiro.test(redWineData$fixed.acidity) #red ##for large samples, results can be significant, even if the distribution is normal
ggplot(wineData, aes(quality)) + geom_histogram()
qqplot.quality <- ggplot(wineData, aes(sample=quality)) + stat_qq() + geom_qq_line()
qqplot.quality



library(car)
wineDataFactored <- wineData
wineDataFactored$quality <- factor(wineData$quality, ordered = T)
leveneTest(wineDataFactored$fixed.acidity, wineDataFactored$quality)

cor(wineData, method="kendall") ##check method based on assumptions
```
##Assumptions for Linear Regression
1.all predictor variables must be quantitative or categorical, and outcome must be quantitative, continuous, and unbounded (Y)
2.non-zero variance (Y)
3.no perfect multicollinearity (predictor variables should not correlate highly) 
4.predictors are uncorrelated with external variables (Y - we have to assume)
5.residuals are homoscedastic (constant variance), independent (test with Durbin-Watson), Normal 
6.linearity (outcome variable means lie on straight line)

##Assumptions for Logistic Regression
1.linearity: linear relationship between continuous predictors and the logit of the outcome variable (see section 8.8.1) 
2.independence of errors: same as linear regression 
3.multicollinearity: same as linear regression 
plus, there are some unique problems of its own: 
1.incomplete information: need full combinations of variables 
2.complete separation: logistic regression fails if your data does not overlap


##cook's distance to quantify influential points - if needed


##Hypothesis

### 1. What factors impact wine quality?
```{r}
wineQuality.model <- lm(quality ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + chlorides + free.sulfur.dioxide + total.sulfur.dioxide + density + pHTransformed + sulphates + alcohol + color, data=wineData)
summary(wineQuality.model)

ggplot(wineData, aes(y=quality, x=fixed.acidity)) + geom_jitter(width=0.1) + facet_grid(~color) ##can use these to separate gender
```
#### Interpretation of Results:


### 2. What factors predict wine colour?
```{r}
# Note, the parameters provided do not include quality since this is a subjective measure.
wineColor.model <- lm(color ~ fixed.acidity + volatile.acidity + citric.acid + residual.sugar + chlorides + free.sulfur.dioxide + total.sulfur.dioxide + density + pHTransformed + sulphates + alcohol, data=wineData)
summary(wineColor.model)

# Remoed variables with low t-values
wineColor.model <- lm(color ~ fixed.acidity + volatile.acidity + residual.sugar + chlorides + total.sulfur.dioxide + density + alcohol, data=wineData)
summary(wineColor.model)
```
#### Interpretation of Results:


### 3. Which wine is better quality: red or white?

t-test assumptions
1.sampling distribution is normally distributed 
2.data are at least interval

the dependent test also requires:
3. scores in different treatment conditions are independent (come from different people) 
4. homogeneity of variance (if you have unequal group sizes)
```{r}
ggplot(redWineData, aes(quality)) + geom_histogram()
ggplot(whiteWineData, aes(quality)) + geom_histogram()

t.test(redWineData$quality, whiteWineData$quality)
#dep.t.test <-t.test(redWineData$quality, whiteWineData$quality, paired=TRUE)

line <- ggplot(wineData, aes(color, quality))
line + stat_summary(fun.y = mean, geom = "line", size = 1, aes(group=1), colour = "#FF6633") + stat_summary(fun.data = mean_cl_boot, geom = "errorbar", width = 0.2, size = 0.75, colour = "#990000") + stat_summary(fun.y = mean, geom = "point", size = 4, colour = "#990000") + stat_summary(fun.y = mean, geom = "point", size = 3, colour = "#FF6633") + labs(x = "color", y = "Quality")
```

The mean quality for red wine and white wine are statistically significant. However, it is not clear that they difference in quality is practically significant the difference between ~5.64 and ~5.87 is not much.

#### Interpretation of Results:

### 4. Logistic
```{R}

```
#### Interpretation of Results:

### 5. ANOVA
assumptions
1.homogeneity of variance 
2.observations are independent 
3.distributions within groups are normally distributed
in some cases, the assumptions don't need to be met there are subtleties here, but in general, with equal group sizes ANOVA is robust to violations of normality homogeneity details in DSUR 10.3.2
```{R}

```
#### Interpretation of Results: